name: Update README thumbnails

on:
  workflow_dispatch:
    inputs:
      folders:
        description: "Folders to include (space-separated)"
        required: true
        default: "Dark Light"
      intro:
        description: "Intro text for the README"
        required: true
        default: |
          # 🖼️ Wallpaper Collection

          /nWallpapers that I use in my Arch-Hyprland setup.
          /nMost are from anime ☑️
          /nSome are cringe 😬

  push:
    paths:
      - "Dark/**"
      - "Light/**"
      - ".github/scripts/update_thumbnails.py"

jobs:
  update-readme-thumbnails:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.x"

      - name: Run README thumbnail generator
        run: |
          INTRO=$(echo -e "${{ github.event.inputs.intro || '# 🖼️ Wallpaper Collection\n\n- Wallpapers that I use in my Arch-Hyprland setup 🪟\n- Most are from anime ☑️\n- Some are cringe 😬' }}")
          FOLDERS="${{ github.event.inputs.folders || 'Dark Light' }}"
          python .github/scripts/update_thumbnails.py "$INTRO" $FOLDERS

      - name: Commit & Push Changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add README.md
          git commit -m "📺 Update README with thumbnails" || echo "No changes to commit"
          git push
